# ğŸšœ Sistema de Controle de TrÃ¡fego de MÃ¡quinas na Colheita de Cana

## 1ï¸âƒ£ Contexto do Projeto

A colheita mecanizada de cana-de-aÃ§Ãºcar tem se tornado essencial para o aumento da produtividade no agronegÃ³cio brasileiro.  
Entretanto, o trÃ¡fego desordenado das mÃ¡quinas agrÃ­colas durante a colheita provoca **compactaÃ§Ã£o do solo**, o que reduz a produtividade e eleva as perdas da lavoura.

Segundo estudos da **CHB Agro** e **SOCICANA**, as perdas podem chegar a **15% da produÃ§Ã£o** devido Ã  mÃ¡ gestÃ£o do deslocamento das colhedoras e caminhÃµes.

Este projeto propÃµe uma **soluÃ§Ã£o computacional em Python (FastAPI)** para **analisar e otimizar o trÃ¡fego das mÃ¡quinas** na lavoura, reduzindo sobreposiÃ§Ãµes e otimizando o rendimento operacional.

---

## 2ï¸âƒ£ Objetivo

Desenvolver um sistema capaz de:

- ğŸ“¡ **Registrar em tempo real** os trajetos das mÃ¡quinas agrÃ­colas (colhedoras, tratores, caminhÃµes);
- ğŸ“ **Coletar coordenadas GPS continuamente** durante a colheita;
- ğŸ§® **Calcular distÃ¢ncias percorridas e Ã¡reas colhidas**;
- âš ï¸ **Detectar sobreposiÃ§Ãµes de rota** entre diferentes mÃ¡quinas;
- ğŸ—ºï¸ **Gerar mapas e relatÃ³rios de anÃ¡lise JSON e PDF** (em desenvolvimento);
- ğŸ’¾ **Armazenar dados persistentemente em banco Oracle**;
- ğŸš¦ **Simular coleta automÃ¡tica de coordenadas** via threads (para testes sem GPS real).

---

## 3ï¸âƒ£ Banco de Dados Oracle

### ğŸ§° Maquinas
```sql
CREATE TABLE maquinas (
    id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    modelo VARCHAR2(100) NOT NULL,
    tipo VARCHAR2(50) NOT NULL,
    ano_fabricacao NUMBER(4),
    status NUMBER(1) DEFAULT 1
);
```

### ğŸŒ¾ Colheitas
```sql
CREATE TABLE colheitas (
    id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    maquina_id INT NOT NULL,
    inicio TIMESTAMP DEFAULT SYSTIMESTAMP,
    fim TIMESTAMP,
    status VARCHAR2(30) DEFAULT 'Em andamento',
    area_colhida NUMBER(10,2),
    duracao NUMBER(10,2),
    FOREIGN KEY (maquina_id) REFERENCES maquinas(id)
);
```

### ğŸ“ Pontos de Trajeto
```sql
CREATE TABLE pontos_trajeto (
    id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    colheita_id INT NOT NULL,
    latitude NUMBER(10,6) NOT NULL,
    longitude NUMBER(10,6) NOT NULL,
    data_registro TIMESTAMP DEFAULT SYSTIMESTAMP,
    FOREIGN KEY (colheita_id) REFERENCES colheitas(id)
);
```

---

## 4ï¸âƒ£ Tecnologias Utilizadas

- ğŸ **Python 3.9+**
- âš¡ **FastAPI** (API moderna e assÃ­ncrona)
- ğŸ”¥ **Uvicorn** (servidor ASGI)
- ğŸ§± **Oracle Database**
- ğŸ§© **Pydantic v2** (validaÃ§Ã£o de dados)
- ğŸ§  **Threading + SimulaÃ§Ã£o de GPS**
- ğŸ“Š (Em desenvolvimento) RelatÃ³rios PDF e anÃ¡lise de sobreposiÃ§Ã£o

---

## 5ï¸âƒ£ Como Rodar o Projeto

1ï¸âƒ£ **Instalar as dependÃªncias**
```bash
pip install -r requirements.txt
```

2ï¸âƒ£ **Executar o servidor FastAPI**
```bash
uvicorn app.main:app --reload
```

3ï¸âƒ£ **Acessar a documentaÃ§Ã£o interativa (Swagger UI)**
```
http://127.0.0.1:8000
```

---

## 6ï¸âƒ£ Endpoints Principais

### ğŸ”§ MÃ¡quinas (`/maquinas`)
- `POST /maquinas/cadastrar` â€” Cadastra nova mÃ¡quina
- `GET /maquinas/listar` â€” Lista todas as mÃ¡quinas
- `PUT /maquinas/editar/{id}` â€” Edita uma mÃ¡quina
- `DELETE /maquinas/excluir/{id}` â€” Exclui uma mÃ¡quina

### ğŸŒ¾ Colheitas (`/colheitas`)
- `POST /colheitas/iniciar` â€” Inicia colheita (simulaÃ§Ã£o de GPS em background)
- `PUT /colheitas/finalizar/{id}` â€” Finaliza colheita e calcula Ã¡rea/duraÃ§Ã£o
- `GET /colheitas/listar` â€” Lista todas as colheitas com dados de mÃ¡quinas

### ğŸ§­ AnÃ¡lise de TrÃ¡fego (em desenvolvimento)
- `GET /analise/trafego/{colheita_id}` â€” Calcula e retorna sobreposiÃ§Ãµes entre mÃ¡quinas e coordenadas para mapa.

---

## 7ï¸âƒ£ Resultados Esperados

- ğŸ“ˆ Monitoramento contÃ­nuo do trÃ¡fego de colhedoras;
- ğŸ“‰ ReduÃ§Ã£o da compactaÃ§Ã£o do solo e das sobreposiÃ§Ãµes de rota;
- ğŸ§® CÃ¡lculo de Ã¡rea colhida em hectares com base em coordenadas GPS;
- ğŸ—ºï¸ GeraÃ§Ã£o futura de mapa interativo com Ã¡reas sobrepostas destacadas.
